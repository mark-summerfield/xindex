#!/usr/bin/env python3
# Copyright © 2015-20 Qtrac Ltd. All rights reserved.

import os
import sys
sys.path.insert(0, os.path.join(os.path.dirname(__file__), ".."))
import unittest

import Pages
from Const import RenumberOptions


class TestPages(unittest.TestCase):

    def setUp(self):
        self.maxDiff = None


    def do_test(self, data):
        for i, (original, expected, options) in enumerate(data):
            with self.subTest(i=i):
                actual = Pages.renumbered(original, options) # CMS16
                if actual != expected:
                    print()
                    print("O", original)
                    print("X", expected)
                    print("A", actual)
                self.assertEqual(actual, expected)


    def test_combinePages0(self):
        self.do_test(DATA0)


    def test_combinePages1(self):
        self.do_test(DATA1)


    def test_combinePages2(self):
        self.do_test(DATA2)


R = RenumberOptions
DATA0 = (
    ("360–365, 461<i>fig</i>, 462tbl, 564–566",
     "360–65, 462<i>fig</i>, 463tbl, 565–67",
     R(0, 0, 0, 400, 999, 1),
     ),
    ("xv, xix–xxii, 360–365, 461<i>fig</i>, 462tbl, 564–566",
     "xiv, xviii–xxi, 360–65, 462<i>fig</i>, 463tbl, 565–67",
     R(1, 999, -1, 400, 999, 1),
     ),
    ("xv, xix–xxii, 360–365, 461<i>fig</i>, 462tbl, 564–566",
     "i, iv–vii, 345–50, 446<i>fig</i>, 447tbl, 549–51",
     R(1, 999, -15, 1, 999, -15),
     ),
    ("xv, xix–xxii, 360–365, 461<i>fig</i>, 462tbl, 564–566",
     "xxv, xxix–xxxii, 370–75, 471<i>fig</i>, 472tbl, 574–76",
     R(1, 999, 10, 1, 999, 10),
     ),
    ("xv, xix–xxii, 360–365, 461<i>fig</i>, 462tbl, 564–566",
     "xv, xix–xxii, 360–65, 461<i>fig</i>, 462tbl, 564–66",
     R(100, 999, 10, 700, 999, 10),
     ),
    ("2, 11–17, 19, 31", "1, 10–16, 18, 30", R(0, 0, 0, 1, 999, -1)),
    ("2, 11–17, 19, 31", "1, 9–15, 17, 29", R(0, 0, 0, 1, 999, -2)),
    ("2, 11–17, 19, 31", "1, 8–14, 16, 28", R(0, 0, 0, 1, 999, -3)),
    ("2, 11–17, 19, 31", "2, 10–16, 18, 31", R(0, 0, 0, 10, 20, -1)),
    ("402, 411–17, 419, 431", "402, 411–17, 419, 431",
     R(1, 999, 1, 1, 400, 1)),
    ("402, 411–17, 419, 431", "402, 411–17, 419, 431",
     R(1, 999, 1, 450, 999, 1)),
    ("""402, <span style="font-size: \
11pt; font-family: 'courier';">411–17</span>, <span \
style="font-size: 11pt; font-family: 'courier';">419</span>, 431""",
     """404, \
<span style="font-size: 11pt; font-family: 'courier';">413</span>–\
<span style="font-size: 11pt; font-family: 'courier';">19</span>, <span \
style="font-size: 11pt; font-family: 'courier';">421</span>, 433""",
     R(0, 0, 0, 1, 999, 2)),
    ("""402, <span style="font-size: \
11pt; font-family: 'courier';">411–17</span>, <span \
style="font-size: 11pt; font-family: 'courier';">419</span>, 431""",
     """400, \
<span style="font-size: 11pt; font-family: 'courier';">409</span>–\
<span style="font-size: 11pt; font-family: 'courier';">15</span>, <span \
style="font-size: 11pt; font-family: 'courier';">417</span>, 429""",
     R(0, 0, 0, 1, 999, -2)),
    ("""402, <span style="font-size: \
11pt; font-family: 'courier';">411–17</span>, <span \
style="font-size: 11pt; font-family: 'courier';">419</span>, 431""",
     """402, \
<span style="font-size: 11pt; font-family: 'courier';">411</span>–\
<span style="font-size: 11pt; font-family: 'courier';">17</span>, <span \
style="font-size: 11pt; font-family: 'courier';">419</span>, 431""",
     R(0, 0, 0, 1, 400, -2)),
    ("""402, <span style="font-size: \
11pt; font-family: 'courier';">411–17</span>, <span \
style="font-size: 11pt; font-family: 'courier';">419</span>, 431""",
     """402, \
<span style="font-size: 11pt; font-family: 'courier';">411</span>–\
<span style="font-size: 11pt; font-family: 'courier';">17</span>, <span \
style="font-size: 11pt; font-family: 'courier';">419</span>, 431""",
     R(0, 0, 0, 450, 999, -2)),
    ("1–6, 10tbl, 15–19, 26fig, 27–28", "6–11, 15tbl, 20–24, 31fig, 32–33",
     R(0, 0, 0, 1, 999, 5)),
    ("""vi, xii, xiv, 4, 12, 18(nn 12, 15), 32, 49, 89, 492""",
     """iii, ix, xi, 1, 9, 15(nn 12, 15), 29, 46, 86, 489""",
     R(1, 999, -3, 1, 999, -3)),
    ("""<i>iv</i>, ix, 4, <b>11t</b>, <i>13f</i>, \
<b>34</b>, 39, 42, <i>88</i>, <b>719</b>""",
     """<i>vi</i>, xi, 9, <b>16t</b>, <i>18f</i>, \
<b>39</b>, 44, 47, <i>93</i>, <b>724</b>""",
     R(1, 999, 2, 1, 999, 5)),
    ("""<b>35</b>(nn. 11, 19), 49, 75<sub>2</sub>, \
<i>81</i><sup><i>a</i></sup>, 85""",
     """<b>33</b>(nn. 11, 19), 47, 73<sub>2</sub>, \
<i>79</i><sup><i>a</i></sup>, 83""",
     R(1, 999, 1, 1, 999, -2)),
    ("101–108, <b>808</b>–833, <i>1103</i>–1104, 1206(nn. <b>83</b>, 91)",
     "112–19, <b>819</b>–44, <i>1114</i>–15, 1217(nn. <b>83</b>, 91)",
     R(0, 0, 0, 1, 2000, 11)),
    ("""xv, 24, <b>32t</b>, 116\u2013118, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">240\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">248\
</span></i>, <i>281f</i>""",
     """v, 4, <b>12t</b>, 96\u201398, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">220\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">28\
</span></i>, <i>261f</i>""",
     R(1, 999, -10, 1, 999, -20)),
    ("102–109, <b>908</b>–933, 2103–<i>2104</i>",
     "104–11, <b>910</b>–35, 2105–<i>6</i>",
     R(0, 0, 0, 100, 2105, 2)),
    ("321–328, 498–532, 1087–1089, 1496–1500, 11564–11615, 12991–13001",
     "321–28, 498–532, 1087–89, 1496–500, 11564–615, 12991–3001",
     R(0, 0, 0, 1, 300, 3)),
    ("321–328, 498–532, 1087–1089, 1496–1500, 11564–11615, 12991–13001",
     "321–28, 498–532, 1087–89, 1496–500, 11564–615, 12991–3001",
     R(0, 0, 0, 2000, 10000, 3)),
    ("321–328, 498–532, 1087–1089, 1496–1500, 11564–11615, 12991–13001",
     "324–31, 501–35, 1090–92, 1499–503, 11567–618, 12994–3004",
     R(0, 0, 0, 1, 13001, 3)),
    ("""vi, xii, <b>xiv</b>\u2013xvii, 4, 12, 32, 49, 89, 492""",
     """vi, xii, <b>xiv</b>\u2013xvii, 4, 12, 32, 49, 89, 492""",
     R(20, 50, 3, 1, 999, 0)),
    ("""vi, xii, <b>xiv</b>\u2013xvii, 4, 12, 32, 49, 89, 492""",
     """ix, xv, <b>xvii</b>\u2013xx, 4, 12, 32, 49, 89, 492""",
     R(1, 999, 3, 1, 999, 0)),
    ("""<i>iv</i>, ix, 4, <b>11t</b>, <i>13f</i>, \
<b>34</b>, 39, 42, <i>88</i>, <b>719</b>""",
     """<i>ii</i>, vii, 2, <b>9t</b>, <i>11f</i>, \
<b>32</b>, 37, 40, <i>86</i>, <b>717</b>""",
     R(1, 999, -2, 1, 999, -2)),
    ("""<b>35</b>, 49, 75<sub>2</sub>, <i>81</i><sup><i>a</i></sup>, 85""",
     """<b>32</b>, 46, 72<sub>2</sub>, <i>78</i><sup><i>a</i></sup>, 82""",
     R(1, 999, 2, 1, 999, -3)),
    ("""xv, 24, <b>32t</b>, 116\u2013118, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">240\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">248\
</span></i>, <i>281f</i>""",
     """xx, 28, <b>36t</b>, 120\u201322, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">244\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">52\
</span></i>, <i>285f</i>""",
     R(1, 999, 5, 1, 999, 4)),
    ("""63, <span style="font-size: 11pt; font-family: \
'arial';">100</span>, <i><span style="font-size: 11pt; font-family: \
'arial';">105</span></i>, 110, 154, <i>177</i><i>\u2013</i><i>182</i>, \
<i>203</i>, <i><b>239</b></i>, 290\u2013293, \
<i>343</i><i>\u2013</i><i>350</i>, <b>482</b>""",
     """68, <span style="font-size: 11pt; font-family: \
'arial';">105</span>, <i><span style="font-size: 11pt; font-family: \
'arial';">110</span></i>, 115, 159, <i>182</i><i>\u2013</i><i>87</i>, \
<i>208</i>, <i><b>244</b></i>, 295\u201398, \
<i>348</i><i>\u2013</i><i>55</i>, <b>487</b>""",
     R(0, 0, 0, 1, 999, 5)),
    ("""47\u2013<i>52</i>, 51<b>t</b>, \
<b>82</b><b>\u2013</b><i><b>84</b></i>, <i>91</i><i><b>f</b></i>, 98, \
420""",
     """42\u2013<i>47</i>, 46<b>t</b>, \
<b>77</b><b>\u2013</b><i><b>79</b></i>, <i>86</i><i><b>f</b></i>, 93, \
415""",
     R(0, 0, 0, 1, 999, -5)),
    ("""<i>2</i>, 47\u2013<i>52</i>, 51<b>t</b>, \
<b>62</b><b>\u2013</b><i><b>64</b></i>, <i>91</i><i><b>f</b></i>, 98, \
<b>117</b>, 420""",
     """<i>1</i>, 44\u2013<i>49</i>, 48<b>t</b>, \
<b>59</b><b>\u2013</b><i><b>61</b></i>, <i>88</i><i><b>f</b></i>, 95, \
<b>114</b>, 417""",
     R(0, 0, 0, 1, 999, -3)),
    ("""iv, xviii, 7, 12, <b>75c</b>, 78, 81<i>f</i>, 92\u201396, \
203<b>t</b>, 206, 255, 290, 300t, 381, 482, 491""",
     """i, xiv, 13, 18, <b>81c</b>, 84, 87<i>f</i>, 98\u2013102, \
209<b>t</b>, 212, 261, 296, 306t, 387, 488, 497""",
     R(1, 999, -4, 1, 999, 6)),
    ("Frontispiece@0.1, 21\u201325 <i>passim</i>, 31, 56\u201374, 83, 91",
     "Frontispiece@0.1, 22\u201326 <i>passim</i>, 32, 57\u201375, 84, 92",
     R(0, 0, 0, 1, 99, 1)),
    ("1.2, 1.3 <i>illus.</i>, 1.8, 1.13, 1.49, 1.98, 2",
     "1, 1.2, 1.3 <i>illus.</i>, 1.8, 1.13, 1.49, 1.98",
     R(0, 0, 0, 1, 99, -1)),
    ("1.2, 1.4, 1.4.1, 1.4.6, 1.4.12, 1.8, 1.13, 1.98, 2",
     "2.2, 2.4, 2.4.1, 2.4.6, 2.4.12, 2.8, 2.13, 2.98, 3",
     R(0, 0, 0, 1, 99, 1)),
    ("""3\u201310, <i>71</i>\u201372, 82\u201385, 87\u2013<i>88</i>, \
96\u2013<b>117</b>, 97\u201399""",
     """1\u20137, <i>68</i>\u201369, 79\u201382, 84\u2013<i>85</i>, \
93\u2013<b>114</b>, 94\u201396""",
     R(0, 0, 0, 1, 999, -3)),
    ("1200\u20131213, 1300\u20131324, 1400\u20131481, 1500\u20131509",
     "1080\u201393, 1180\u2013204, 1280\u2013361, 1380\u201389",
     R(0, 0, 0, 1000, 2000, -120)),
    )

DATA1 = (
    ("""100\u2013104, 110\u2013115, 120\u2013128, 1100\u20131113, \
1200\u20131207, 1300\u20131334, 1400\u20131595, 1500\u20131581""",
     """98\u2013102, 108\u201313, 118\u201326, 1098\u2013111, \
1198\u2013205, 1298\u2013332, 1398\u2013593, 1498\u2013579""",
     R(0, 0, 0, 1, 2000, -2)),
    ("""101\u2013108, 202\u2013215, 304\u2013309, 808\u2013833, \
909\u2013911, 1103\u20131104, 1205\u20131216, 1308\u20131401""",
     """108\u201315, 209\u201322, 311\u201316, 815\u201340, \
916\u201318, 1110\u201311, 1212\u201323, 1315\u2013408""",
     R(0, 0, 0, 1, 9999, 7)),
    ("""321\u2013328, 418\u2013419, 498\u2013532, 1087\u20131089, \
1287\u20131289, 1496\u20131500, 11564\u201311615, 12991\u201313001""",
     """314\u201321, 411\u201312, 491\u2013525, 1080\u201382, \
1280\u201382, 1489\u201393, 11557\u2013608, 12984\u201394""",
     R(0, 0, 0, 1, 99999, -7)),
    ("101\u2013108, 808\u2013833, 909\u2013921, 1103\u20131104, \
1202\u20131206",
     "95\u2013102, 802\u201327, 903\u201315, 1097\u201398, \
1196\u2013200",
     R(1, 999, 1, 1, 9999, -6)),
    ("101–108, 808–833, 1103–1104", "107–14, 814–39, 1109–10",
     R(0, 0, 0, 1, 9999, 6)),
    ("321–328, 498–532, 1087–1089, 1496–1500, 11564–11615, 12991–13001",
     "327–34, 504–38, 1093–95, 1502–6, 11570–621, 12997–3007",
     R(0, 0, 0, 1, 99999, 6)),
    ("Frontispiece, 14\u201318 passim, 21, 89, 106–108n., 202f",
     "Frontispiece, 9\u201313 passim, 16, 84, 101–103n., 197f",
     R(1, 999, 1, 1, 999, -5)),
    ("<b>13</b>:10:19\u201321, <b>20</b>:46:5, <b>21</b>:3:15",
     "<b>18</b>:10:19\u201326, <b>25</b>:46:5, <b>26</b>:3:15",
     R(1, 999, 1, 1, 999, 5)),
    ("mcmlxv, mcmlxx", "mcmlx, mcmlxv",
     R(1, 3999, -5, 1, 999, 5)),
    ("mcmlxv, mcmlxx", "mcmlxx, mcmlxxv",
     R(1, 3999, 5, 1, 999, 5)),
    ("53(vii)A, 53(vii)B, 53(ix)A", "49(vii)A, 49(vii)B, 49(ix)A",
     R(1, 3999, 5, 1, 999, -4)),
    ("53(vii)A, 53(vii)B, 53(ix)A", "57(vii)A, 57(vii)B, 57(ix)A",
     R(1, 3999, 5, 1, 999, 4)),
    # ("A-2, Plate XIV, 18, 45\u201347", "A-2, Plate XIV, 15, 42\u201344",
    #  R(1, 3999, -2, 1, 999, -3)),
    # ("A-2, Plate XIV, 18, 45\u201347", "A-2, Plate XIV, 21, 48\u201350",
    #  R(1, 3999, 2, 1, 999, 3)),
    ("II:5, II:7\u20139, II:24, II:55", "I:5, I:7\u201310, I:24, I:55",
     R(1, 3999, -2, 1, 999, 1)),
    ("II:5, II:7\u20139, II:24, II:55", "IV:5, IV:7\u201310, IV:24, IV:55",
     R(1, 3999, 2, 1, 999, 1)),
    ("32\u201338, 40fig, 45t, 45(map), 45(ph), 75\u201378",
     "34\u201340, 42fig, 47t, 47(map), 47(ph), 77\u201380",
     R(1, 3999, -2, 1, 999, 2)),
    ("32\u201338, 40fig, 45t, 45(map), 45(ph), 75\u201378",
     "30\u201336, 38fig, 43t, 43(map), 43(ph), 73\u201376",
     R(1, 3999, 2, 1, 999, -2)),
    ("IV:2.3.1(a), 2:435, Plate IV@45, 56t12, Plate XI@56.1, 63a\u201366b",
     "I:2.3.1(a), 5:435, Plate IV@45, Plate XI@56.1, 59t12, 66a\u201369b",
     R(1, 3999, -3, 1, 999, 3)),
    ("IV:2.3.1(a), 2:435, Plate IV@45, 56t12, Plate XI@56.1, 63a\u201366b",
     "VII:2.3.1(a), 1:435, Plate IV@45, 53t12, Plate XI@56.1, 60a\u201363b",
     R(1, 3999, 3, 1, 999, -3)),
    ("56(t12), 71(nn 23, 27), 85(nn. 15, 18), 91t.13, 105n14, 112n26",
     "52(t12), 67(nn 23, 27), 81(nn. 15, 18), 87t.13, 101n14, 108n26",
     R(1, 3999, 5, 1, 999, -4)),
    ("56(t12), 71(nn 23, 27), 85(nn. 15, 18), 91t.13, 105n14, 112n26",
     "60(t12), 75(nn 23, 27), 89(nn. 15, 18), 95t.13, 109n14, 116n26",
     R(1, 3999, -5, 1, 999, 4)),
    # ("REF-10, STR-5, STR-23, STR-24, UTL-4",
    #  "REF-10, STR-5, STR-23, STR-24, UTL-4",
    #  R(1, 3999, -5, 1, 999, 4)),
    )

DATA2 = (
    ("""vi, xii, xiv, 4, 12, 18(nn 12, 15), 32, 49, 89, 492""",
     """v, xi, xiii, 3, 11, 17(nn 12, 15), 31, 48, 88, 491""",
     R(1, 3999, -1, 1, 9999, -1)),
    ("""vi, xii, xiv, 4, 12, 18(nn 12, 15), 32, 49, 89, 492""",
     """vii, xiii, xv, 5, 13, 19(nn 12, 15), 33, 50, 90, 493""",
     R(1, 3999, 1, 1, 9999, 1)),
    ("""<i>iv</i>, ix, 4, <b>11t</b>, <i>13f</i>, \
<b>34</b>, 39, 42, <i>88</i>, <b>719</b>""",
     """<i>ii</i>, vii, 2, <b>9t</b>, <i>11f</i>, \
<b>32</b>, 37, 40, <i>86</i>, <b>717</b>""",
     R(1, 3999, -2, 1, 9999, -2)),
    ("""<i>iv</i>, ix, 4, <b>11t</b>, <i>13f</i>, \
<b>34</b>, 39, 42, <i>88</i>, <b>719</b>""",
     """<i>vi</i>, xi, 6, <b>13t</b>, <i>15f</i>, \
<b>36</b>, 41, 44, <i>90</i>, <b>721</b>""",
     R(1, 3999, 2, 1, 9999, 2)),
    ("""<b>35</b>(nn. 11, 19), 49, 75<sub>2</sub>, \
<i>81</i><sup><i>a</i></sup>, 85""",
     """<b>32</b>(nn. 11, 19), 46, 72<sub>2</sub>, \
<i>78</i><sup><i>a</i></sup>, 82""",
     R(1, 3999, -3, 1, 9999, -3)),
    ("101–8, <b>808</b>–33, <i>1103</i>–4, 1206(nn. <b>83</b>, 91)",
     "104–11, <b>811</b>–36, <i>1106</i>–7, 1209(nn. <b>83</b>, 91)",
     R(1, 3999, 3, 1, 9999, 3)),
    ("""xv, 24, <b>32t</b>, 116\u201318, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">240\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">48\
</span></i>, <i>281f</i>""",
     """xi, 20, <b>28t</b>, 112\u201314, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">236\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">44\
</span></i>, <i>277f</i>""",
     R(1, 3999, -4, 1, 9999, -4)),
    ("102–9, <b>908</b>–33, 2103–<i>4</i>",
     "106–13, <b>912</b>–37, 2107–<i>8</i>",
     R(1, 3999, 4, 1, 9999, 4)),
    ("321–28, 498–532, 1087–89, 1496–500, 11564–615, 12991–3001",
     "316–23, 493–527, 1082–84, 1491–95, 11559–610, 12986–96",
     R(1, 3999, -5, 1, 99999, -5)),
    ("""vi, xii, <b>xiv</b>\u2013xvii, 4, 12, 32, 49, 89, 492""",
     """xii, xviii, <b>xx</b>\u2013xxiii, 10, 18, 38, 55, 95, 498""",
     R(1, 3999, 6, 1, 99999, 6)),
    ("""<i>iv</i>, ix, 4, <b>11t</b>, <i>13f</i>, \
<b>34</b>, 39, 42, <i>88</i>, <b>719</b>""",
     """<i>i</i>, ii, 1, <b>4t</b>, <i>6f</i>, \
<b>27</b>, 32, 35, <i>81</i>, <b>712</b>""",
     R(1, 3999, -7, 1, 99999, -7)),
    ("""<b>35</b>, 49, 75<sub>2</sub>, \
<i>81</i><sup><i>a</i></sup>, 85""",
     """<b>43</b>, 57, 83<sub>2</sub>, \
<i>89</i><sup><i>a</i></sup>, 93""",
     R(1, 3999, 8, 1, 99999, 8)),
    ("""xv, 24, <b>32t</b>, 116\u201318, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">240\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">48\
</span></i>, <i>281f</i>""",
     """vii, 16, <b>24t</b>, 108\u201310, \
<i><span style="font-size: 11pt; font-family: 'times new roman';">232\
</span></i><i>\u2013</i>\
<i><span style="font-size: 11pt; font-family: 'times new roman';">40\
</span></i>, <i>273f</i>""",
     R(1, 3999, -8, 1, 99999, -8)),
    ("""63, <span style="font-size: 11pt; font-family: \
'arial';">100</span>, <i><span style="font-size: 11pt; font-family: \
'arial';">105</span></i>, 110, 154, <i>177</i><i>\u2013</i><i>82</i>, \
<i>203</i>, <i><b>239</b></i>, 290\u201393, \
<i>343</i><i>\u2013</i><i>50</i>, <b>482</b>""",
     """72, <span style="font-size: 11pt; font-family: \
'arial';">109</span>, <i><span style="font-size: 11pt; font-family: \
'arial';">114</span></i>, 119, 163, <i>186</i><i>\u2013</i><i>91</i>, \
<i>212</i>, <i><b>248</b></i>, 299\u2013302, \
<i>352</i><i>\u2013</i><i>59</i>, <b>491</b>""",
     R(1, 3999, 9, 1, 99999, 9)),
    ("290\u201393", "299\u2013302", R(0, 0, 0, 1, 999, 9)),
    ("""47\u2013<i>52</i>, 51<b>t</b>, \
<b>82</b><b>\u2013</b><i><b>84</b></i>, <i>91</i><i><b>f</b></i>, 98, \
420""",
     """38\u2013<i>43</i>, 42<b>t</b>, \
<b>73</b><b>\u2013</b><i><b>75</b></i>, <i>82</i><i><b>f</b></i>, 89, \
411""",
     R(1, 3999, -9, 1, 99999, -9)),
    ("""<i>2</i>, 47\u2013<i>52</i>, 51<b>t</b>, \
<b>62</b><b>\u2013</b><i><b>64</b></i>, <i>91</i><i><b>f</b></i>, 98, \
<b>117</b>, 420""",
     """<i>12</i>, 57\u2013<i>62</i>, 61<b>t</b>, \
<b>72</b><b>\u2013</b><i><b>74</b></i>, <i>101</i><i><b>f</b></i>, 108, \
<b>127</b>, 430""",
     R(1, 3999, 10, 1, 99999, 10)),
    ("""iv, xviii, 7, 12, <b>75c</b>, 78, 81<i>f</i>, 92\u201396, \
203<b>t</b>, 206, 255, 290, 300t, 381, 482, 491""",
     """i, vii, 1, <b>64c</b>, 67, 70<i>f</i>, 81\u201385, \
192<b>t</b>, 195, 244, 279, 289t, 370, 471, 480""",
     R(1, 3999, -11, 1, 99999, -11)),
    ("Frontispiece@0.1, 21\u201325 <i>passim</i>, 31, 56\u201374, 83, 91",
     "Frontispiece@0.1, 33\u201337 <i>passim</i>, 43, 68\u201386, 95, 103",
     R(1, 3999, 12, 1, 99999, 12)),
    ("1.2, 1.3 <i>illus.</i>, 1.8, 1.13, 1.49, 1.98, 2",
     "1, 1.2, 1.3 <i>illus.</i>, 1.8, 1.13, 1.49, 1.98",
     R(1, 3999, -1, 1, 99999, -1)),
    ("""3\u201310, <i>71</i>\u201372, 82\u201385, 87\u2013<i>88</i>, \
96\u2013<b>117</b>, 97\u201399""",
     """4\u201311, <i>72</i>\u201373, 83\u201386, 88\u2013<i>89</i>, \
97\u2013<b>118</b>, 98\u2013100""",
     R(1, 3999, 1, 1, 99999, 1)),
    ("1200\u20131213, 1300\u20131324, 1400\u20131481, 1500\u20131509",
     "1199\u2013212, 1299\u2013323, 1399\u2013480, 1499\u2013508",
     R(1, 3999, -1, 1, 99999, -1)),
    ("""100\u2013104, 110\u201315, 120\u201328, 1100\u20131113, \
1200\u20131207, 1300\u20131334, 1400\u20131595, 1500\u20131581""",
     """102\u20136, 112\u201317, 122\u201330, 1102\u201315, \
1202\u20139, 1302\u201336, 1402\u2013597, 1502\u201383""",
     R(1, 3999, 2, 1, 99999, 2)),
    ("""101\u20138, 202\u201315, 304\u20139, 808\u201333, \
909\u201311, 1103\u20134, 1205\u201316, 1308\u2013401""",
     """99\u2013106, 200\u2013213, 302\u20137, 806\u201331, \
907\u20139, 1101\u20132, 1203\u201314, 1306\u201399""",
     R(1, 3999, -2, 1, 99999, -2)),
    ("""321\u201328, 418\u201319, 498\u2013532, 1087\u201389, \
1287\u201389, 1496\u2013500, 11564\u2013615, 12991\u20133001""",
     """324\u201331, 421\u201322, 501\u201335, 1090\u201392, \
1290\u201392, 1499\u2013503, 11567\u2013618, 12994\u20133004""",
     R(1, 3999, 3, 1, 99999, 3)),
    ("101\u20138, 808\u201333, 909\u201321, 1103\u20134, 1202\u20136",
     "98\u2013105, 805\u201330, 906\u201318, 1100\u20131101, 1199\u2013203",
     R(1, 3999, -3, 1, 99999, -3)),
    ("101–8, 808–33, 1103–4", "105–12, 812–37, 1107–8",
     R(1, 3999, 4, 1, 99999, 4)),
    ("321–28, 498–532, 1087–89, 1496–500, 11564–615, 12991–3001",
     "317–24, 494–528, 1083–85, 1492–96, 11560–611, 12987–97",
     R(1, 3999, -4, 1, 99999, -4)),
    ("Frontispiece, 13\u201318 passim, 21, 89, 106–108n., 202f",
     "Frontispiece, 18\u201323 passim, 26, 94, 111–113n., 207f",
     R(1, 3999, 5, 1, 99999, 5)),
    ("<b>13</b>:10:19\u201321, <b>20</b>:46:5, <b>21</b>:3:15",
     "<b>8</b>:10:19\u201316, <b>15</b>:46:5, <b>16</b>:3:15",
     R(1, 3999, -5, 1, 99999, -5)),
    ("mcmlxv, mcmlxx", "mcmlxxi, mcmlxxvi",
     R(1, 3999, 6, 1, 99999, 6)),
    ("mcmlxv, mcmlxx", "mcmlix, mcmlxiv",
     R(1, 3999, -6, 1, 99999, -6)),
    ("53(vii)A, 53(vii)B, 53(ix)A", "60(vii)A, 60(vii)B, 60(ix)A",
     R(1, 3999, 7, 1, 99999, 7)),
    ("53(vii)A, 53(vii)B, 53(ix)A", "46(vii)A, 46(vii)B, 46(ix)A",
     R(1, 3999, -7, 1, 99999, -7)),
    # ("A-2, Plate XIV, 18, 45\u201347", "A-2, Plate XIV, 26, 53\u201355",
    #  R(1, 3999, 8, 1, 99999, 8)),
    ("32\u201338, 40fig, 45t, 45(map), 45(ph), 75\u201378",
     "24\u201330, 32fig, 37t, 37(map), 37(ph), 67\u201370",
     R(1, 3999, -8, 1, 99999, -8)),
    ("IV:2.3.1(a), 2:435, Plate IV@45, 56t12, Plate XI@56.1, 63a\u201366b",
     "XIII:2.3.1(a), 11:435, Plate IV@45, Plate XI@56.1, 65t12, \
72a\u201375b",
     R(1, 3999, 9, 1, 99999, 9)),
    ("56(t12), 71(nn 23, 27), 85(nn. 15, 18), 91t.13, 105n14, 112n26",
     "47(t12), 62(nn 23, 27), 76(nn. 15, 18), 82t.13, 96n14, 103n26",
     R(1, 3999, -9, 1, 99999, -9)),
    # ("REF-10, STR-5, STR-23, STR-24, UTL-4",
    #  "REF-10, STR-5, STR-23, STR-24, UTL-4",
    #  R(1, 3999, -9, 1, 99999, -9)),
    )


if __name__ == "__main__":
    unittest.main()
